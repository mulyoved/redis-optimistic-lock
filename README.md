implement the logic described in http://redis.io/topics/transactions Optimistic locking using check-and-set